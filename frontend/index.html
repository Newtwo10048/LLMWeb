<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>é‹å‹•å“¡ç‡Ÿé¤Šå¸« AI</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="container">
    <header>
      <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='36' height='36'><rect rx='8' width='36' height='36' fill='%230b6efd'/><text x='50%' y='57%' font-size='18' text-anchor='middle' fill='white' font-family='Arial'>AI</text></svg>" alt="logo"/>
      <h1>é‹å‹•å“¡ç‡Ÿé¤Šå¸« AI</h1>
    </header>

    <!-- å°è¦½åˆ— -->
    <nav id="mainTabs">
      <button class="tab active" data-panel="loginPanel">ç™»å…¥</button>
      <button class="tab" data-panel="registerPanel">è¨»å†Š</button>
      <button class="tab" data-panel="profilePanel">å€‹äººè³‡è¨Š</button>
      <button class="tab" data-panel="goalsPanel">ç›®æ¨™</button>
      <button class="tab" data-panel="dietPanel">é£²é£Ÿç´€éŒ„ & å»ºè­°</button>
      <button class="tab" data-panel="habitsPanel">é‹å‹•ç¿’æ…£</button>
      <button class="tab" data-panel="qaPanel">AI å•ç­”</button>
      <button class="tab" data-panel="nutrientPanel">ç‡Ÿé¤Šç´ æŸ¥è©¢</button>
      <button class="tab" data-panel="foodPanel">é£Ÿç‰©è³‡æ–™åº«</button>
      <button class="tab" data-panel="recipePanel">é£Ÿè­œç‡Ÿé¤Šåˆ†æ</button>
    </nav>

    <section class="panel">

      <div id="loginPanel" class="panelCard">
        <div class="card">
          <h3>ç™»å…¥</h3>
          <form id="loginForm" style="display:flex;gap:8px;align-items:center">
            <input id="loginEmail" placeholder="é›»å­éƒµä»¶" />
            <input id="loginPass" type="password" placeholder="å¯†ç¢¼" />
            <button type="submit">ç™»å…¥</button>
          </form>
          <p id="loginHint" class="muted"></p>
          
          <!-- Google ç™»å…¥ -->
          <div style="margin-top: 20px; text-align: center;">
            <p style="color: #666; margin-bottom: 10px;">æˆ–ä½¿ç”¨</p>
            <div id="g_id_onload"
              data-client_id="1012981023049-ei8qt2b4qp2n8o0uulpku50tb4cgv4ot.apps.googleusercontent.com"
              data-callback="handleGoogleLogin"
              data-auto_prompt="false">
            </div>
            <div class="g_id_signin" 
              data-type="standard"
              data-shape="rectangular"
              data-theme="outline"
              data-text="signin_with"
              data-size="large"
              data-locale="zh_TW">
            </div>
          </div>
        </div>
      </div>
      <!-- è¨»å†Š -->
      <div id="registerPanel" class="panelCard" style="display:none">
        <div class="register-container">
    <div class="register-header">
      <h1>ğŸƒâ€â™‚ï¸ å»ºç«‹å¸³è™Ÿ</h1>
      <p>é–‹å§‹æ‚¨çš„é‹å‹•å“¡ç‡Ÿé¤Šç®¡ç†ä¹‹æ—…</p>
    </div>

    <form id="registerForm" onsubmit="return false;">
      <div class="form-group">
        <label for="register-email">Email å¸³è™Ÿ</label>
        <input 
          type="email" 
          id="register-email" 
          name="email"
          placeholder="your@email.com"
          autocomplete="email"
        >
      </div>

      <div class="form-group">
        <label for="register-password">å¯†ç¢¼</label>
        <input 
          type="password" 
          id="register-password" 
          name="password"
          placeholder="è‡³å°‘ 6 å€‹å­—å…ƒ"
          autocomplete="new-password"
        >
        <div class="password-strength">
          <div class="strength-bar">
            <div class="strength-fill" id="strengthFill"></div>
          </div>
        </div>
        <div class="requirements">
          <ul>
            <li id="req-length">è‡³å°‘ 6 å€‹å­—å…ƒ</li>
            <li id="req-letter">åŒ…å«è‹±æ–‡å­—æ¯</li>
            <li id="req-number">åŒ…å«æ•¸å­— (å»ºè­°)</li>
          </ul>
        </div>
      </div>

      <div class="form-group">
        <label for="register-confirm">ç¢ºèªå¯†ç¢¼</label>
        <input 
          type="password" 
          id="register-confirm" 
          name="confirm"
          placeholder="å†æ¬¡è¼¸å…¥å¯†ç¢¼"
          autocomplete="new-password"
        >
      </div>

      <button type="button" id="register-btn" class="register-btn">
        è¨»å†Šå¸³è™Ÿ
      </button>

      <div id="register-msg" class="register-msg"></div>
    </form>

    <div class="login-link">
      å·²æœ‰å¸³è™Ÿï¼Ÿ<a href="index.html">ç«‹å³ç™»å…¥</a>
    </div>
  </div>
      </div>
      <!-- å€‹äººè³‡è¨Š -->
      <div id="profilePanel" class="panelCard" style="display:none">
        <div class="card">
          <h3>å€‹äººè³‡è¨Š</h3>
          <form id="profileForm" class="grid">
            <div>
              <label>å§“å</label>
              <input id="name" />
            </div>
            <div>
              <label>ç”Ÿæ—¥</label>
              <input id="birthday" type="date" />
            </div>
            <div>
              <label>èº«é«˜ (cm)</label>
              <input id="height" type="number" />
            </div>
            <div>
              <label>é«”é‡ (kg)</label>
              <input id="weight" type="number" />
            </div>
            <div>
              <label>é‹å‹•ç¨®é¡</label>
              <select id="sportType">
                <option value="baseball">æ£’çƒ</option>
                <option value="football">è¶³çƒ</option>
                <option value="general">ç¶œåˆè¨“ç·´</option>
              </select>
            </div>
            <div>
              <label>æ€§åˆ¥</label>
              <select id="gender">
                <option value="male">ç”·</option>
                <option value="female">å¥³</option>
                <option value="other">å…¶ä»–</option>
              </select>
            </div>
            <div class="full">
              <label>å‚™è¨»ï¼ˆéæ•ã€ç‰¹æ®Šé£²é£Ÿï¼‰</label>
              <textarea id="notes"></textarea>
            </div>
            <div class="full row">
              <button id="saveProfile" type="button">å„²å­˜</button>
              <button id="loadProfile" type="button">è¼‰å…¥</button>
            </div>
          </form>
        </div>
      </div>
      
      <!-- GOALS -->
      <div id="goalsPanel" class="panelCard" style="display:none">
        <div class="card">
          <h3>ç›®æ¨™è¨­å®š</h3>
          <label>çŸ­æœŸç›®æ¨™</label>
          <input id="goalShort" />
          <label>é•·æœŸç›®æ¨™</label>
          <input id="goalLong" />
          <div style="margin-top:10px">
            <button id="saveGoals" type="button">å„²å­˜ç›®æ¨™</button>
          </div>
        </div>
      </div>

      <!-- DIET & CHARTS -->
      <div id="dietPanel" class="panelCard" style="display:none">
        <div class="card">
          <h3>é£²é£Ÿç´€éŒ„ & å»ºè­°</h3>
          <div style="display:flex;gap:12px">
            <div style="flex:1">
              <label>æ–°å¢é£²é£Ÿç´€éŒ„ï¼ˆç¯„ä¾‹: é›èƒ¸ 150gï¼‰</label>
              <div class="row">
                <input id="foodName" placeholder="é£Ÿç‰©åç¨±" />
                <input id="foodGrams" type="number" placeholder="å…‹æ•¸" class="small" />
                <button id="addLog" type="button">åŠ å…¥ç´€éŒ„</button>
              </div>
              <div class="log-list" id="logs"></div>
            </div>
            <div style="width:480px">
              <label>å»ºè­°åœ–è¡¨</label>
              <div class="chart-wrap">
                <div class="chart-box card"><canvas id="pieChart"></canvas></div>
                <div class="chart-box card"><canvas id="servingChart"></canvas></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- HABITS -->
      <div id="habitsPanel" class="panelCard" style="display:none">
        <div class="card">
          <h3>é‹å‹•ç¨®é¡ã€é »ç‡èˆ‡æ™‚é•·</h3>
          <div class="grid">
            <div>
              <label>æ¯é€±è¨“ç·´æ¬¡æ•¸</label>
              <input id="freqPerWeek" type="number" />
            </div>
            <div>
              <label>æ¯æ¬¡æ™‚é•·ï¼ˆåˆ†é˜ï¼‰</label>
              <input id="durationMin" type="number" />
            </div>
            <div class="full">
              <label>é£²é£Ÿç¿’æ…£ï¼ˆå‹¾é¸ï¼‰</label>
              <div class="row">
                <label><input type="checkbox" id="mealBreakfast"> æ—©é¤</label>
                <label><input type="checkbox" id="mealLunch"> åˆé¤</label>
                <label><input type="checkbox" id="mealDinner"> æ™šé¤</label>
                <label><input type="checkbox" id="mealLate"> å®µå¤œ</label>
              </div>
            </div>
            <div class="full row"><button id="saveHabits">å„²å­˜ç¿’æ…£</button></div>
          </div>
        </div>
      </div>

      <!-- QA -->
      <div id="qaPanel" class="panelCard" style="display:none">
        <div class="card">
          <h3>AI å•ç­”</h3>
          <button id="clearHistoryBtn" onclick="clearChatHistory()" 
           style="padding: 8px 16px; background: #ff6b6b; color: white; border: none; border-radius: 6px; cursor: pointer;">
             ğŸ—‘ï¸ æ¸…é™¤æ­·å²
          </button>
          <textarea id="qaInput" placeholder="è¼¸å…¥å•é¡Œï¼Œä¾‹å¦‚ï¼šæˆ‘æ˜å¤©æŠ•æ‰‹æ¯”è³½ï¼Œè©²åƒä»€éº¼ï¼Ÿ"></textarea>
          <button id="askBtn">é€å‡ºçµ¦ AI</button>
          <h4>å°è©±æ­·å²</h4>
          <div id="qaResponse" class="muted" style="height:200px; overflow:auto; border:1px solid #ccc; padding:4px"></div>
        </div>
      </div>


      <!-- NUTRIENT SEARCH -->
      <div id="nutrientPanel" class="panelCard" style="display:none">
        <div class="card">
          <h3>ç‡Ÿé¤Šç´ æŸ¥è©¢ï¼ˆåœ–ç‰‡ / æ–‡å­—ï¼‰</h3>
          <label>æ–‡å­—æŸ¥è©¢</label>
          <div class="row">
            <input id="nutrientQuery" placeholder="ä¾‹å¦‚ï¼šé›èƒ¸ è‚Œé…¸ å«é‡"/>
            <button id="nutrientSearch">æŸ¥è©¢</button>
          </div>

          <label style="margin-top:10px">ä¸Šå‚³é£Ÿç‰©åœ–ç‰‡ï¼ˆå¾Œç«¯é ˆå¯¦ä½œå½±åƒè¾¨è­˜ + RAGï¼‰</label>
          <div class="row">
            <input type="file" id="imgUpload" accept="image/*" />
            <button id="imgSearch">ç”¨åœ–ç‰‡æŸ¥è©¢</button>
          </div>
          <img id="imgPreview" class="img-preview" src="" />

          <h4>æŸ¥è©¢çµæœ</h4>
          <div id="nutrientResult" class="muted"></div>
        </div>
      </div>
      <!-- food table-->
      <div id="foodPanel" class="panelCard" style="display:none">
        <div class="card">
          <h3>é£Ÿç‰©è¼¸å…¥</h3>
            <form id="foodForm">
              <input placeholder="Name" id="foodname" required><br>
              <input placeholder="Portion size per day" id="portion"><br>
              <input placeholder="Cal/100g" id="cal" type="number" step="0.1"><br>
              <input placeholder="Carbon/100g" id="carbon" type="number" step="0.1"><br>
              <input placeholder="Protein/100g" id="protein" type="number" step="0.1"><br>
              <input placeholder="Fats/100g" id="fats" type="number" step="0.1"><br>
              <input placeholder="Flavor (sweet, sour...)" id="flavor"><br>
              <input placeholder="Category" id="category"><br>
              <textarea placeholder="Description" id="desc"></textarea><br>
              <button id="addFood" type="button">Add Food</button>
            </form>
            <div class="foodList" id="foods"></div>
            <div id="foodList"></div>
        </div>
      </div>
      <!-- recipe table-->
       <div id="recipePanel" class="panelCard" style="display:none">
        <div class="card">
          <title>é£Ÿè­œç‡Ÿé¤Šåˆ†æ</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Microsoft JhengHei', Arial, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                padding: 20px;
            }

            .container {
                max-width: 1200px;
                margin: 0 auto;
            }

            .card {
                background: white;
                border-radius: 16px;
                box-shadow: 0 10px 40px rgba(0,0,0,0.1);
                padding: 30px;
                margin-bottom: 20px;
            }

            h1 {
                color: #667eea;
                margin-bottom: 30px;
                font-size: 32px;
            }

            h2 {
                color: #333;
                margin-bottom: 20px;
                font-size: 24px;
            }

            .input-section {
                margin-bottom: 30px;
            }

            label {
                display: block;
                margin-bottom: 8px;
                color: #555;
                font-weight: 600;
            }

            input[type="text"],
            input[type="number"],
            textarea {
                width: 100%;
                padding: 12px;
                border: 2px solid #e0e0e0;
                border-radius: 8px;
                font-size: 16px;
                transition: border-color 0.3s;
            }

            input:focus,
            textarea:focus {
                outline: none;
                border-color: #667eea;
            }

            textarea {
                min-height: 200px;
                resize: vertical;
                font-family: inherit;
            }

            .button-group {
                display: flex;
                gap: 15px;
                margin-top: 20px;
            }

            button {
                padding: 12px 30px;
                border: none;
                border-radius: 8px;
                font-size: 16px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s;
            }

            .btn-primary {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
            }

            .btn-primary:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
            }

            .btn-secondary {
                background: #f0f0f0;
                color: #333;
            }

            .btn-secondary:hover {
                background: #e0e0e0;
            }

            button:disabled {
                opacity: 0.5;
                cursor: not-allowed;
            }

            .result-section {
                display: none;
                margin-top: 30px;
            }

            .result-section.show {
                display: block;
            }

            .nutrition-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 20px;
                margin-bottom: 30px;
            }

            .nutrition-card {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 20px;
                border-radius: 12px;
                text-align: center;
            }

            .nutrition-label {
                font-size: 14px;
                opacity: 0.9;
                margin-bottom: 8px;
            }

            .nutrition-value {
                font-size: 32px;
                font-weight: bold;
                margin-bottom: 5px;
            }

            .nutrition-unit {
                font-size: 12px;
                opacity: 0.8;
            }

            .ingredients-list {
                background: #f9f9f9;
                padding: 20px;
                border-radius: 8px;
                margin-bottom: 20px;
            }

            .ingredient-item {
                padding: 10px;
                border-bottom: 1px solid #e0e0e0;
            }

            .ingredient-item:last-child {
                border-bottom: none;
            }

            .recipe-text {
                background: #f9f9f9;
                padding: 20px;
                border-radius: 8px;
                line-height: 1.8;
                white-space: pre-wrap;
            }

            .loading {
                text-align: center;
                padding: 40px;
                color: #667eea;
            }

            .spinner {
                border: 4px solid #f3f3f3;
                border-top: 4px solid #667eea;
                border-radius: 50%;
                width: 50px;
                height: 50px;
                animation: spin 1s linear infinite;
                margin: 0 auto 20px;
            }

            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }

            .recipe-list {
                margin-top: 30px;
            }

            .recipe-item {
                background: #f9f9f9;
                padding: 20px;
                border-radius: 8px;
                margin-bottom: 15px;
                cursor: pointer;
                transition: transform 0.3s, box-shadow 0.3s;
            }

            .recipe-item:hover {
                transform: translateY(-2px);
                box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            }

            .recipe-item-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 10px;
            }

            .recipe-item-title {
                font-size: 20px;
                font-weight: 600;
                color: #333;
            }

            .recipe-item-date {
                font-size: 14px;
                color: #999;
            }

            .recipe-item-nutrition {
                display: flex;
                gap: 15px;
                font-size: 14px;
                color: #666;
            }

            .message {
                padding: 15px;
                border-radius: 8px;
                margin-bottom: 20px;
            }

            .message.success {
                background: #d4edda;
                color: #155724;
                border: 1px solid #c3e6cb;
            }

            .message.error {
                background: #f8d7da;
                color: #721c24;
                border: 1px solid #f5c6cb;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="card">
                <h1>ğŸ³ é£Ÿè­œç‡Ÿé¤Šåˆ†æç³»çµ±</h1>

                <!-- è¼¸å…¥å€åŸŸ -->
                <div class="input-section">
                    <div style="margin-bottom: 20px;">
                        <label for="recipeName">é£Ÿè­œåç¨±</label>
                        <input type="text" id="recipeName" placeholder="ä¾‹å¦‚ï¼šé›èƒ¸è‚‰æ²™æ‹‰">
                    </div>

                    <div style="margin-bottom: 20px;">
                        <label for="servings">ä»½æ•¸</label>
                        <input type="number" id="servings" value="1" min="1">
                    </div>

                    <div>
                        <label for="recipeContent">é£Ÿè­œå…§å®¹</label>
                        <textarea 
                            id="recipeContent" 
                            placeholder="è«‹è¼¸å…¥å®Œæ•´çš„é£Ÿè­œå…§å®¹ï¼ŒåŒ…æ‹¬é£Ÿæå’Œä½œæ³•...

    ä¾‹å¦‚ï¼š
    é›èƒ¸è‚‰ 200g
    ç”Ÿèœ 100g
    å°ç•ªèŒ„ 50g
    æ©„æ¬–æ²¹ 1å¤§åŒ™
    æª¸æª¬æ± é©é‡

    ä½œæ³•ï¼š
    1. é›èƒ¸è‚‰ç…ç†Ÿåˆ‡ç‰‡
    2. ç”Ÿèœæ´—æ·¨æ’•æˆé©ç•¶å¤§å°
    3. å°ç•ªèŒ„å°åŠåˆ‡
    4. å…¨éƒ¨æ··åˆï¼Œæ·‹ä¸Šæ©„æ¬–æ²¹å’Œæª¸æª¬æ±"></textarea>
                    </div>

                    <div class="button-group">
                        <button class="btn-primary" id="analyzeBtn" onclick="analyzeRecipe()">
                            ğŸ¤– AI åˆ†æç‡Ÿé¤Šæˆåˆ†
                        </button>
                        <button class="btn-secondary" onclick="clearForm()">
                            æ¸…é™¤
                        </button>
                    </div>
                </div>

                <!-- è¼‰å…¥å‹•ç•« -->
                <div id="loadingSection" class="loading" style="display: none;">
                    <div class="spinner"></div>
                    <p>AI æ­£åœ¨åˆ†æé£Ÿè­œ...</p>
                    <p id="aiResponse" style="margin-top: 15px; color: #999; font-size: 14px;"></p>
                </div>

                <!-- åˆ†æçµæœ -->
                <div id="resultSection" class="result-section">
                    <h2>ğŸ“Š ç‡Ÿé¤Šåˆ†æçµæœ</h2>

                    <div class="nutrition-grid" id="nutritionGrid"></div>

                    <h3 style="margin-bottom: 15px;">ğŸ¥— é£Ÿææ¸…å–®</h3>
                    <div class="ingredients-list" id="ingredientsList"></div>

                    <h3 style="margin-bottom: 15px;">ğŸ“ é£Ÿè­œæ­¥é©Ÿ</h3>
                    <div class="recipe-text" id="recipeText"></div>

                    <div class="button-group">
                        <button class="btn-primary" onclick="saveRecipe()">
                            ğŸ’¾ å„²å­˜é£Ÿè­œ
                        </button>
                        <button class="btn-secondary" onclick="analyzeAgain()">
                            é‡æ–°åˆ†æ
                        </button>
                    </div>
                </div>
            </div>

            <!-- å·²å„²å­˜çš„é£Ÿè­œåˆ—è¡¨ -->
            <div class="card">
                <h2>ğŸ“š æˆ‘çš„é£Ÿè­œ</h2>
                <div id="recipeList" class="recipe-list"></div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
  <script src="script.js"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>

</body>
</html>
